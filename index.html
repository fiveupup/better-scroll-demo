<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="css/index.css">

</head>

<body>
    <div class="list-wrapper">
        <div class="scroll-content">
            <div class="index-list-content">
                <div class="index-list-title">

                </div>
                <ul>
                    <li>
                        <h2 class="index-list-anchor">
                            热门城市
                        </h2>
                        <ul>
                            <li class="index-list-item border-bottom-1px">北京市</li>
                            <li class="index-list-item border-bottom-1px">上海市</li>
                            <li class="index-list-item border-bottom-1px">深圳市</li>
                        </ul>
                    </li>
                    <li>
                        <h2 class="index-list-anchor">
                            A
                        </h2>
                        <ul>
                            <li class="index-list-item border-bottom-1px">鞍山市</li>
                            <li class="index-list-item border-bottom-1px">安庆市</li>
                        </ul>
                    </li>
                    <li>
                        <h2 class="index-list-anchor">
                            B
                        </h2>
                        <ul>
                            <li class="index-list-item border-bottom-1px">北京市</li>
                            <li class="index-list-item border-bottom-1px">北海市</li>
                            <li class="index-list-item border-bottom-1px">巴音布鲁克</li>
                        </ul>

                    </li>
                    <li>
                        <h2 class="index-list-anchor">
                            C
                        </h2>
                        <ul>
                            <li class="index-list-item border-bottom-1px">成都市</li>
                            <li class="index-list-item border-bottom-1px">重庆市</li>
                            <li class="index-list-item border-bottom-1px">常州市</li>
                        </ul>
                    </li>
                    <li>
                        <h2 class="index-list-anchor">
                            E
                        </h2>
                        <ul>
                            <li class="index-list-item border-bottom-1px">鄂尔多斯市</li>
                            <li class="index-list-item border-bottom-1px">洱海市</li>
                            <li class="index-list-item border-bottom-1px">常州市</li>
                        </ul>
                    </li>
                    <li>
                        <h2 class="index-list-anchor">
                            F
                        </h2>
                        <ul>
                            <li class="index-list-item border-bottom-1px">福州市</li>
                            <li class="index-list-item border-bottom-1px">佛山市</li>
                            <li class="index-list-item border-bottom-1px">防城港市</li>
                        </ul>
                    </li>
                    <li>
                        <h2 class="index-list-anchor">
                            G
                        </h2>
                        <ul>
                            <li class="index-list-item border-bottom-1px">广州市</li>
                            <li class="index-list-item border-bottom-1px">贵阳市</li>
                        </ul>
                    </li>
                    <li>
                        <h2 class="index-list-anchor">
                            H
                        </h2>
                        <ul>
                            <li class="index-list-item border-bottom-1px">杭州市</li>
                            <li class="index-list-item border-bottom-1px">和田地区</li>
                        </ul>
                    </li>
                    <li>
                        <h2 class="index-list-anchor">
                            Z
                        </h2>
                        <ul>
                            <li class="index-list-item border-bottom-1px">郑州市</li>
                            <li class="index-list-item border-bottom-1px">张家口市</li>
                            <li class="index-list-item border-bottom-1px">张家界市</li>
                            <li class="index-list-item border-bottom-1px">枣庄市</li>
                            <li class="index-list-item border-bottom-1px">舟山市</li>
                            <li class="index-list-item border-bottom-1px">自贡市</li>
                            <li class="index-list-item border-bottom-1px">遵义市</li>
                            <li class="index-list-item border-bottom-1px">资阳市</li>
                            <li class="index-list-item border-bottom-1px">珠海市</li>
                            <li class="index-list-item border-bottom-1px">中山市</li>
                            <li class="index-list-item border-bottom-1px">中卫市</li>
                        </ul>
                    </li>
                    
                </ul>
            </div>
        </div>
    </div>
    <div class="index-list-nav">
        <ul>
            <li data-index="0" class="active">
                *
            </li>
            <li data-index="1">
                A
            </li>
            <li data-index="2">
                B
            </li>
            <li data-index="3">
                C
            </li>
            <li data-index="4">
                E
            </li>
            <li data-index="5">
                F
            </li>
            <li data-index="6">
                G
            </li>
            <li data-index="7">
                H
            </li>
            <li data-index="8">
                Z
            </li>
        </ul>
    </div>
    <div class="index-list-fixed" style="display: none;">
        A
    </div>
    <script src="https://unpkg.com/better-scroll@latest/dist/better-scroll.min.js"></script>

    <script>
        {
            let listWrapper = document.querySelector(".list-wrapper");
            let listAnchor = document.querySelectorAll(".index-list-anchor");
            let listNav = document.querySelector(`.index-list-nav`);
            let activeListNav = document.querySelectorAll(`.index-list-nav li`);
            let indexListFixed = document.querySelector(".index-list-fixed");
            let bscroll = BetterScroll.createBScroll(listWrapper, {
                probeType: 3,
                scrollY: true
            });

            bscroll.on("scroll", () => {
                var activeIndex = -1;
                listAnchor.forEach((item, index) => {
                    let t = item.getBoundingClientRect().top;
                    if (t <= 0) {
                        activeIndex = index;
                    }
                });
                //let activeListNav = document.querySelector(`.index-list-nav li[data-index="${activeIndex}"]`);nsole.log(activeListNav);
                activeListNav.forEach((item, index) => {
                    item.classList.remove("active");
                });
                activeListNav[activeIndex < 0 ? 0 : activeIndex].classList.add("active");

                if (activeIndex > 0) {
                    indexListFixed.style.display = "block";
                    indexListFixed.innerHTML = listAnchor[activeIndex].innerHTML;
                } else {
                    indexListFixed.style.display = "none";
                }

            });

            let getActive = (e) => {
                // 可视区坐标
                let clientY = e.changedTouches[0].clientY;
                // 减去父容器的坐标
                //clientY -= listNav.getBoundingClientRect().top;

                var activeIndex = -1;
                for(let i=0; i < activeListNav.length; i++) {
                    let rect = activeListNav[i].getBoundingClientRect();
                    let t = rect.top;
                    let b = rect.bottom;
                    if (clientY <= b && clientY >= t) {
                        activeIndex = i;
                        break;
                    }
                }

                if(activeIndex >= 0) {
                    console.log(activeListNav[activeIndex]);
                    bscroll.scrollToElement(listAnchor[activeIndex], 500,0,1);
                }

            };

            listNav.addEventListener("touchmove", getActive);

            listNav.addEventListener("touchstart", getActive);




        }


    </script>
</body>


</html>